---
title: "Introdução ao Ambiente R"
subtitle: "Criando tabelas com o pacote kableExtra"
author: "Marlon"
date: "3/22/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

------------------------------------------------------------------------

<br>

O Pacote `kableExtra` é um pacote voltado para edição de tabelas. Mais detalhes podem ser obtidos [aqui](http://haozhu233.github.io/kableExtra/awesome_table_in_pdf.pdf), [aqui](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html) e no bookdown [aqui.](https://bookdown.org/yihui/rmarkdown-cookbook/kableextra.html#kableextra)

<br>

Se você não tem o pacote instaldo execulte o comando abaixo. Para isso, pode selecionar a linha e executar somente ela. Depois não será necessário instalar novamente o pacote.

```{r}
# install.packages("kableExtra")
```

<br>

Carregando pacote

```{r}
library(kableExtra)
```

<br>

# Tabela de resumo estatístico

<br>

Usaremos nosso conjunto de dados preferido: Iris

<br>

```{r,  warning=FALSE, message=FALSE, echo = FALSE}
# Carregando os pacotes
library(tidyverse)
library(rstatix)
```

<br>

```{r}

# Modificar os nomes das variáveis que estão em inglés. Aqui, fica mais fácil, mudar no conjunto de dados. 
# Criarei um data frame com as modificações no conjunto de dados iris

df <- iris %>% rename("Comp. Sépala" = "Sepal.Length",
                      "Larg. Sépala" = "Sepal.Width",
                      "Comp. Pétala" = "Petal.Length",
                      "Larg. Pétala" = "Petal.Width")
df$Species<- fct_recode(df$Species, Setosa = "setosa", Versicolor = "versicolor", Virginica = "virginica")

# 1° - Criamos um objeto com o resumo estatístico


resumo <- df %>% group_by(Species) %>% get_summary_stats(type = "common")

resumo
```

<br>

Podemos exportar essa tabela compiando e jogando no excel e lá organizar como quizermos para inserir no word, por exemplo. Mas não é o caso aqui. Asim, vamos modifica-la para ficar mais com o formato que queremos.

<br>

```{r}
# A forma mais simples
kable(resumo)

```

<br>

Mas está tudo embolado, e não é isso que queremos, certo?

<br>

```{r}
kable(resumo) %>% kable_styling()
```

<br>

Já melhorou muito, mas pode ficar melhor. Por exemplo: veja que o nome das espécies estão se repetindo ao longo da coluna um. Não queremos isso, e sim que elas apareçam uma única vez. vamos ver como fazer isso.

<br>

```{r}
  kable(resumo) %>% 
  collapse_rows(1, valign="top") %>%
 kable_styling()

# collapse_rows, faz com que a coluna com a variável que o fator se organize; e valign onde a palavra ficará; troque "top" por "middle"
```

<br>

Agora a tabela ficou com uma formatação melhor. Agora vamos mudar os nomes das colunas.

<br>

```{r}
kable(resumo, "html",
      col.names = c("Espécie", "variável", "n", "Menor","Maior", "Mediana", "iQR", "Média", "DP", "EP", "IC")) %>% 
kable_styling() %>%
collapse_rows(1, valign = "top")


```

<br>

Agora, vamos colocar um título à nossa tabela.

<br>

```{r}
kable(resumo, "html",
      col.names = c("Espécie", "variável", "n", "Menor","Maior", "Mediana", "iQR", "Média", "DP", "EP", "IC"),
      caption = "Resumo estatístico") %>% 
kable_styling() %>%
collapse_rows(1, valign = "top") %>%
 add_footnote("Rodapé 1", notation="alphabet") # Nota de rodapé
```

<br>

Essa é uma ideia de como usar o pacote `kableExtra`para formatação de tabelas.
